---
title: "Exploratory Analysis"
output: html_notebook
---

Imports
```{r}
#Import Libraries
library(tidyverse)
library(readxl)
library(reticulate)
library(ggplot2)
library(ggpubr)

#Import Python
source("..\\config.R") #sources python_path
use_python(python_path, required = TRUE)

#Import Data
source_python('feature_creation.py')
```

Data Cleaning
```{r}
modeling_data <- df_features %>%
  select(-SEVEN_LETTERS, -CENTER_LETTER) %>% #Drop non-numerical variables
  mutate(NUM_SOLUTIONS_LOG = log(NUM_SOLUTIONS, 10)) #Log transform target variable

```

Distribution of Data
```{r}
#Histogram of Number of Solutions (Raw)
solutions_hist <- ggplot(
  data = modeling_data, aes(x = NUM_SOLUTIONS)) +
  geom_histogram(binwidth = 1) +
  labs(title = "Number of Solutions (Raw)")

#Histogram of Number of Solutions (Log Transformation)
solutions_hist_log <- ggplot(
  data = modeling_data, aes(x = NUM_SOLUTIONS_LOG)) +
  geom_histogram(binwidth = 0.005) +
  labs(title = "Number of Solutions (Log)")

#Combine histograms into figure
figure_dist <- ggarrange(solutions_hist, solutions_hist_log,
                    ncol = 2, nrow = 1) %>%
  annotate_figure(top = "Solutions Distribution")

figure_dist
```

Calculate Pearson Correlations
```{r}
#Correlation Matrix
cor_matrix <- cor(modeling_data, method = "pearson")

#Keep Correlations for number of solutions only
cor_summary <- cor_matrix %>%
  as.data.frame() %>%
  select(NUM_SOLUTIONS, NUM_SOLUTIONS_LOG) %>%
  rename(
    correlation_raw = NUM_SOLUTIONS,
    correlation_log = NUM_SOLUTIONS_LOG) %>%
  mutate(
    correlation_raw_mag = abs(correlation_raw),
    correlation_log_mag = abs(correlation_log))
```

Impact of Number of Vowels
```{r}
vowesl_scatter <- ggplot(data = modeling_data,
       aes(x = factor(NUM_VOWELS), y= NUM_SOLUTIONS)) +
  geom_boxplot()

```

